<!--
/*
 *  The MIT License
 * 
 *  Copyright 2011 Greg.
 * 
 *  Permission is hereby granted, free of charge, to any person obtaining a copy
 *  of this software and associated documentation files (the "Software"), to deal
 *  in the Software without restriction, including without limitation the rights
 *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 *  copies of the Software, and to permit persons to whom the Software is
 *  furnished to do so, subject to the following conditions:
 * 
 *  The above copyright notice and this permission notice shall be included in
 *  all copies or substantial portions of the Software.
 * 
 *  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 *  THE SOFTWARE.
 */
-->
<html><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1252">
<title>LR(1) Parser Generator</title>
<style>
body { background-color: #F0F0F0; }
body * { font-family:courier; }
td { horizontal-align: middle; vertical-align: top; white-space: nowrap; }
th { white-space: nowrap; }
</style>
<script language="javascript" src="LR(1)%20Parser%20Generator_files/underscore.js"></script>
<script language="javascript" src="LR(1)%20Parser%20Generator_files/tools.js"></script>
<script language="javascript" src="LR(1)%20Parser%20Generator_files/grammar.js"></script>
<script language="javascript" src="LR(1)%20Parser%20Generator_files/grammarview.js"></script>
<script language="javascript" src="LR(1)%20Parser%20Generator_files/lr1item.js"></script>
<script language="javascript" src="LR(1)%20Parser%20Generator_files/lrclosuretable.js"></script>
<script language="javascript" src="LR(1)%20Parser%20Generator_files/lrclosuretableview.js"></script>
<script language="javascript" src="LR(1)%20Parser%20Generator_files/tree.js"></script>
<script language="javascript" src="LR(1)%20Parser%20Generator_files/treeview.js"></script>
<script language="javascript" src="LR(1)%20Parser%20Generator_files/lrtable.js"></script>
<script language="javascript" src="LR(1)%20Parser%20Generator_files/lrtableview.js"></script>
<script language="javascript" src="LR(1)%20Parser%20Generator_files/lrparseview.js"></script>
</head>
<body>
<script language="javascript">


var lrTable;

function grammarChanged() {
	displayRuleIndices();
	
	//var grammar = new Grammar($element('grammar').value);
	var lrClosureTable = new LRClosureTable(grammar);
	lrTable = new LRTable(lrClosureTable);

	$element('firstFollowView').innerHTML = formatFirstFollow(grammar);
	$element('lrClosureTableView').innerHTML = formatLRClosureTable(lrClosureTable);
	$element('lrTableView').innerHTML = formatLRTable(lrTable);
	
	parseInput();
}

function therunner() {
	var parainput = $element('parainput').value;
	//var params = { "input": parainput }

	//const url='http://localhost:3000/?input='+parainput;

	var url = new URL('http://localhost:3000/')

	var params = {input: parainput};
	url.search = new URLSearchParams(params).toString();
	
	//fetch(url).then(data => {return data.json()})
	//		.then(res => {console.log(res)}).catch(error => {console.log(error)});
	fetch(url).then(data => {console.log(data);return data.json()})
			.then(res => {console.log(res)}).catch(error => {console.log(error)});
	
	var str = "";
	var i = 0;
	while(i < parainput.length) {
		if(parainput[i] != '.') {
			str += parainput[i];
		}
		else  {
			$element('input').value = str;
			str = "";
			grammarChanged();
			var result = parseInput();
			console.log(result);
		}
		i++;
	}
	
}

</script>
<table><tbody><tr>
	<td>
	<div id="grammarView" hidden>
	</div>
	<br>
	<div id ='firstFollowView' hidden></div>
	<div style="height: 100%; overflow: auto;">
		<div id="lrClosureTableView"hidden></div>
		<div id="lrTableView" hidden></div>
	</td>
	<td> 
			<div id="lrParseView">
			</div>
			<textarea id='acc-state'></textarea>
			<textarea id='parainput' rows='7' cols='30'></textarea>
			<button onclick="therunner()">RUNNER</button>
	</td></tr></tbody></table>
	</div>
</td></tr>
</tbody></table>


<script language="javascript">
{
	var grammar = new Grammar('S\' -> S\n\
S -> N V N\n\
N -> d n\n\
N -> d ad n\n\
N -> p n\n\
N -> p\n\
N -> n\n\
V -> v\n\
V -> v a\n\
V -> v v\n\
V -> v a v');

	$element('grammarView').innerHTML = formatGrammar(grammar);
}

$element('lrParseView').innerHTML = formatInitialParseView('', 100);

</script>
</body></html>